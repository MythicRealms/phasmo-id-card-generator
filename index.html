<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phasmo ID Card Generator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- React and ReactDOM CDNs -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- html2canvas CDN for image download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Base styles for full height and no default margins/padding */
        html, body, #root {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: auto; /* Allow scrolling on the main page if content exceeds viewport */
            font-family: 'Inter', sans-serif; /* Apply Inter font globally */
        }

        /* Custom scrollbar for better aesthetics */
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-track {
            background: #2d3748; /* bg-gray-800 */
        }
        body::-webkit-scrollbar-thumb {
            background-color: #e53e3e; /* bg-red-600 */
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Function to convert a number to a Roman numeral
        const toRoman = (num) => {
            if (typeof num !== 'number' || !Number.isInteger(num) || num < 1 || num > 3999) {
                return String(num); // Return as string if invalid or not an integer
            }

            const romanMap = [
                { value: 1000, numeral: 'M' },
                { value: 900, numeral: 'CM' },
                { value: 500, numeral: 'D' },
                { value: 400, numeral: 'CD' },
                { value: 100, numeral: 'C' },
                { value: 90, numeral: 'XC' },
                { value: 50, numeral: 'L' },
                { value: 40, numeral: 'XL' },
                { value: 10, numeral: 'X' },
                { value: 9, numeral: 'IX' },
                { value: 5, numeral: 'V' },
                { value: 4, numeral: 'IV' },
                { value: 1, numeral: 'I' },
            ];

            let result = '';
            for (const { value, numeral } of romanMap) {
                while (num >= value) {
                    result += numeral;
                    num -= value;
                }
            }
            return result;
        };

        const App = () => {
            // State variables for ID card details
            const [agentName, setAgentName] = useState('HAMMOND');
            const [rank, setRank] = useState('PARANORMAL INVESTIGATOR');
            const [prestige, setPrestige] = useState(1);
            const [actualLevel, setActualLevel] = useState(97);
            const [preferredGear, setPreferredGear] = useState('Spirit Box, EMF Reader, Flashlight');
            const [specialization, setSpecialization] = useState('Ghost Type Identification');
            const [profileImage, setProfileImage] = useState('https://placehold.co/250x350/000000/FFFFFF?text=Upload+Image'); // Placeholder
            const [teamName, setTeamName] = useState('Ghost Hunters Inc.');
            const [idNumber, setIdNumber] = useState('PHASMO-001');

            const idCardRef = useRef(null);

            const handleImageUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setProfileImage(reader.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const downloadIdCard = () => {
                if (idCardRef.current) {
                    if (window.html2canvas) {
                        window.html2canvas(idCardRef.current, {
                            scale: 2,
                            useCORS: true,
                            logging: true,
                        }).then(canvas => {
                            const link = document.createElement('a');
                            link.download = 'phasmo-id-card.png';
                            link.href = canvas.toDataURL('image/png');
                            link.click();
                        }).catch(error => {
                            console.error("Error generating ID card image:", error);
                            alert("Failed to generate ID card image. Please try again.");
                        });
                    } else {
                        console.error("html2canvas is not loaded. Cannot download ID card.");
                        alert("Image download feature is not ready. Please try again in a moment.");
                    }
                }
            };

            return (
                <div className="min-h-screen bg-gray-900 text-gray-100 p-4 flex flex-col items-center justify-start gap-8 w-full">
                    {/* Input Form Section - Horizontal Bar at the Top */}
                    <div className="w-full bg-gray-800 rounded-xl shadow-2xl p-6 md:p-8">
                        <h1 className="text-3xl font-bold text-red-500 mb-6 text-center">Create Your Phasmo ID</h1>

                        <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                            <div className="min-w-0">
                                <label htmlFor="agentName" className="block text-sm font-medium text-gray-300 mb-1">Agent Name</label>
                                <input type="text" id="agentName" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={agentName} onChange={(e) => setAgentName(e.target.value)} placeholder="e.g., John Doe" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="rank" className="block text-sm font-medium text-gray-300 mb-1">Main Title</label>
                                <input type="text" id="rank" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={rank} onChange={(e) => setRank(e.target.value)} placeholder="e.g., Investigator" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="prestige" className="block text-sm font-medium text-gray-300 mb-1">Prestige</label>
                                <input type="number" id="prestige" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={prestige} onChange={(e) => setPrestige(parseInt(e.target.value) || 0)} placeholder="e.g., 1" min="0" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="actualLevel" className="block text-sm font-medium text-gray-300 mb-1">Level</label>
                                <input type="number" id="actualLevel" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={actualLevel} onChange={(e) => setActualLevel(parseInt(e.target.value) || 0)} placeholder="e.g., 97" min="0" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="preferredGear" className="block text-sm font-medium text-gray-300 mb-1">Preferred Gear</label>
                                <input type="text" id="preferredGear" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={preferredGear} onChange={(e) => setPreferredGear(e.target.value)} placeholder="e.g., Spirit Box" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="specialization" className="block text-sm font-medium text-gray-300 mb-1">Specialization</label>
                                <input type="text" id="specialization" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={specialization} onChange={(e) => setSpecialization(e.target.value)} placeholder="e.g., Evidence Collector" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="teamName" className="block text-sm font-medium text-gray-300 mb-1">Team Name</label>
                                <input type="text" id="teamName" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={teamName} onChange={(e) => setTeamName(e.target.value)} placeholder="e.g., Ghost Hunters" />
                            </div>
                            <div className="min-w-0">
                                <label htmlFor="idNumber" className="block text-sm font-medium text-gray-300 mb-1">ID Number</label>
                                <input type="text" id="idNumber" className="w-full p-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-red-500 focus:border-red-500 text-white placeholder-gray-400" value={idNumber} onChange={(e) => setIdNumber(e.target.value)} placeholder="e.g., PHASMO-007" />
                            </div>
                            <div className="col-span-full sm:col-span-2 md:col-span-3 lg:col-span-4 xl:col-span-5 min-w-0">
                                <label htmlFor="profileImageUpload" className="block text-sm font-medium text-gray-300 mb-1">Upload Profile Image</label>
                                <input type="file" id="profileImageUpload" accept="image/*" className="w-full text-white text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer" onChange={handleImageUpload} />
                            </div>
                            <div className="col-span-full sm:col-span-2 md:col-span-3 lg:col-span-4 xl:col-span-5 min-w-0">
                                <button onClick={downloadIdCard} className="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                                    Download ID Card
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* ID Card Display Section - centered below the form */}
                    <div className="flex-shrink-0 mx-auto w-full flex justify-center">
                        <div
                            ref={idCardRef}
                            className="relative bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 rounded-xl shadow-2xl overflow-hidden border-2 border-red-500"
                            style={{
                                width: 'min(100%, 1000px)', /* Responsive width, max 1000px */
                                minWidth: '500px', /* Minimum width for visibility */
                                aspectRatio: '1000 / 553', /* Maintain aspect ratio */
                                backgroundImage: 'url("data:image/svg+xml,%3Csvg width=\'6\' height=\'6\' viewBox=\'0 0 6 6\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'%239C92AC\' fill-opacity=\'0.1\' fill-rule=\'evenodd\'%3E%3Cpath d=\'M5 0h1L0 6V5zM6 5v1H5z\'/%3E%3C/g%3E%3C/svg%3E")', /* Subtle pattern */
                                backgroundSize: 'cover',
                                backgroundPosition: 'center',
                                boxShadow: 'inset 0 0 50px rgba(0,0,0,0.5)'
                            }}
                        >
                            {/* Top Header: PARANORMAL INVESTIGATOR */}
                            <div className="absolute top-0 left-0 right-0 bg-red-700 text-white text-center py-4 px-6 rounded-t-xl" style={{ height: '70px' }}>
                                <h2 className="text-4xl font-extrabold uppercase tracking-widest leading-none" style={{ textShadow: '2px 2px 4px rgba(0,0,0,0.5)' }}>
                                    {rank}
                                </h2>
                            </div>

                            {/* Main Content Area */}
                            <div className="absolute top-[70px] left-0 right-0 bottom-0 flex items-center justify-start p-8">
                                {/* Left Section: Image, Name, Level */}
                                <div className="flex items-center h-full">
                                    {/* Profile Image Container */}
                                    <div className="w-[250px] h-[350px] rounded-xl overflow-hidden border-4 border-gray-400 bg-gray-600 shadow-lg flex-shrink-0"
                                        style={{
                                            marginLeft: '20px',
                                            marginTop: '20px',
                                            borderRadius: '15px'
                                        }}
                                    >
                                        <img
                                            src={profileImage}
                                            alt="Profile"
                                            className="w-full h-full object-cover"
                                            onError={(e) => {
                                                e.target.onerror = null;
                                                e.target.src = 'https://placehold.co/250x350/000000/FFFFFF?text=Image+Error';
                                            }}
                                        />
                                    </div>

                                    {/* Name and Level Text */}
                                    <div className="ml-10 mt-10"> {/* Adjusted margin for spacing */}
                                        <p className="text-xl font-bold text-white uppercase mb-1">NAME</p>
                                        <h3 className="text-6xl font-extrabold text-red-500 uppercase tracking-wide leading-tight" style={{ textShadow: '3px 3px 6px rgba(0,0,0,0.7)' }}>
                                            {agentName}
                                        </h3>
                                        <p className="text-xl font-bold text-white uppercase mt-4 mb-1">LEVEL</p>
                                        <h3 className="text-5xl font-extrabold text-red-500 uppercase tracking-wide leading-tight" style={{ textShadow: '3px 3px 6px rgba(0,0,0,0.7)' }}>
                                            {`${toRoman(prestige)}-${actualLevel}`}
                                        </h3>
                                    </div>
                                </div>

                                {/* Right Section: Badges - Horizontally aligned and positioned */}
                                <div className="absolute right-8 top-1/2 -translate-y-1/2 flex flex-row items-center justify-center space-x-8">
                                    {/* Badge 1 (Microphone) */}
                                    <div className="w-40 h-40 rounded-full bg-yellow-500 border-4 border-yellow-300 flex items-center justify-center shadow-xl"
                                        style={{
                                            background: 'linear-gradient(145deg, #FFD700, #DAA520)',
                                            boxShadow: '0px 0px 20px rgba(255,215,0,0.7)'
                                        }}
                                    >
                                        <svg className="w-24 h-24 text-gray-800" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3.53-2.64 6.43-6 6.92V21h-2v-3.08c-3.36-.49-6-3.39-6-6.92H3c0 4.84 3.44 8.87 8 9.8V23h2v-2.18c4.56-.93 8-4.96 8-9.8h-2.7z"/>
                                        </svg>
                                    </div>

                                    {/* Badge 2 (Laurel Wreath) */}
                                    <div className="w-40 h-40 rounded-full bg-yellow-500 border-4 border-yellow-300 flex items-center justify-center shadow-xl"
                                        style={{
                                            background: 'linear-gradient(145deg, #FFD700, #DAA520)',
                                            boxShadow: '0px 0px 20px rgba(255,215,0,0.7)'
                                        }}
                                    >
                                        <svg className="w-24 h-24 text-gray-800" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM9 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM15 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM12 9c-.83 0-1.5-.67-1.5-1.5S11.17 6 12 6s1.5.67 1.5 1.5S12.83 9 12 9z"/>
                                            <path fillRule="evenodd" clipRule="evenodd" d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9zm-4 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm8 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-4-8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
